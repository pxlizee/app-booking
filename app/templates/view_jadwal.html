{% extends "base.html" %}

{% block title %}Lihat Jadwal{% endblock %}

{% block content %}
<h3 class="mb-4 text-decoration-underline"><i class="bi bi-calendar-event me-2"></i>Jadwal Saat Ini</h3>

<div class="card border-0 shadow-lg bg-light mb-4">
    <div class="card-body p-4">
        <h5 class="card-title mb-3"><i class="bi bi-filter-circle me-2"></i>Filter & Aksi Jadwal</h5>
        <form method="GET" action="{{ url_for('routes.halaman_jadwal') }}" class="row g-3 align-items-center">
            <div class="col-lg-3">
                <select class="form-select form-select-sm" name="filter_by">
                    <option value="Hari" {% if filter_by == 'Hari' %}selected{% endif %}>Hari</option>
                    <option value="Ruangan" {% if filter_by == 'Ruangan' %}selected{% endif %}>Ruangan</option>
                    <option value="Kelas" {% if filter_by == 'Kelas' %}selected{% endif %}>Kelas</option>
                    <option value="Dosen" {% if filter_by == 'Dosen' %}selected{% endif %}>Dosen</option>
                </select>
            </div>
            <div class="col-lg-5">
                <input type="text" class="form-control form-control-sm" name="filter_value" placeholder="Ketik nilai filter..." value="{{ filter_value }}">
            </div>
            <div class="col-lg-2">
                <button type="submit" class="btn btn-outline-primary w-100 btn-sm"><i class="bi bi-search"></i> Filter</button>
            </div>
            <div class="col-lg-2">
                <a href="#" class="btn btn-outline-success w-100 btn-sm"><i class="bi bi-file-earmark-excel"></i> Excel</a>
            </div>
        </form>
        {% if current_user.role == 'admin' %}
        <div class="d-grid gap-2 mt-3">
             <form method="POST" action="#" onsubmit="return confirm('Apakah Anda yakin ingin menghapus SEMUA jadwal? Aksi ini tidak dapat dibatalkan!');">
                <button type="submit" class="btn btn-outline-danger w-100"><i class="bi bi-trash-fill me-2"></i>Hapus Semua Jadwal</button>
            </form>
        </div>
        {% endif %}
    </div>
</div>

{% if jadwal_list %}
<div class="table-responsive">
    <table class="table table-bordered table-sm">
        <thead class="table-light text-primary">
            <tr>
                {% for col in header %}
                <th scope="col">{{ col }}</th>
                {% endfor %}
                <th scope="col">Aksi</th>
            </tr>
        </thead>
        <tbody>
            {% for item in jadwal_list %}
            <tr>
                <td>{{ item.id }}</td>
                <td>{{ item.nama_dosen }}</td>
                <td>{{ item.mata_kuliah }}</td>
                <td>{{ item.sks }}</td>
                <td>{{ item.kelas }}</td>
                <td>{{ item.hari }}</td>
                <td>{{ item.jam_mulai }}</td>
                <td>{{ item.jam_selesai }}</td>
                <td>{{ item.gedung }}</td>
                <td>{{ item.lantai }}</td>
                <td>{{ item.ruangan }}</td>
                <td>{{ item.tipe_kelas }}</td>
                <td>
                    {% if current_user.role == 'admin' %}
                    <form method="POST" action="#" onsubmit="return confirm('Yakin ingin menghapus jadwal ini?');" style="display:inline;">
                        <button type="submit" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash-fill"></i></button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-warning text-center" role="alert">
    Tidak ada jadwal yang ditemukan. Silakan coba filter yang lain atau buat jadwal baru.
</div>
{% endif %}

{% endblock %}